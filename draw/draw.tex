\documentclass{article}

\usepackage{tikz}
\usetikzlibrary{math}
\usetikzlibrary{calc}

\newcommand{\heegaard}[4]{ % arguments-to-math key: the four-tuple (p, a, b, r) is represented by (#1, #2, #3, #4)
  \begin{tikzpicture}[
    dot/.style = {circle, fill, minimum size=#1,
      inner sep=0pt, outer sep=0pt},
    dot/.default = 6pt
    ]
    \tikzmath{ % everything else
      \points = #1;
      \maxy = \points + 1;
      \maxx = \points;
      \discs = #2;
      \abov = #3;
      \belo = \points - 2*\discs - \abov;
      \shift = #4 - 1;
      \discmidl = \maxy - \discs - 0.5;
      \discmidr = \maxy - \abov - \discs - \shift - 0.5;
      % annoyingly, these functions don't seem to be able to output coordinates.
      % this is a fix: a function call that emulates a coordinate depending on an axis parameter
      function proj(\vala, \valb, \whaxis) {
        if \whaxis == 0 then {
          return \vala;
        } else {
          return \valb;
        };
      };
      % given an input node number, return the number of the node it's connected to.
      % first coordinate if axis = 0; second otherwise.
      function otherend(\n, \axis) {
        if \n <= \points then { % left side
          if \n <= 2*\discs then { % disc point
            \endpoint = 2 * \discs - \n + 1;
            return proj(abs(\n - \discs - 0.5), \discmidl, \axis);
          } else {
            if \n <= \points - \belo then { % above arc
              \endpoint = mod(\n + \points - 2*\discs + \shift - 1, \points) + 1;
              return proj(\maxx, \maxy - \endpoint, \axis);
            } else { % below arc
              \endpoint = mod(\n + \shift - 1, \points) + \points + 1;
              if \endpoint - \points < \n then { % warps
                return proj(\maxx - \n + 1, 0, \axis);
              } else { % no warp
                return proj(\maxx, \maxy - \endpoint - \points, \axis);
              };
            };
          };
        } else { % right side
          \preimage = mod(\n - \shift - 1, \points) + 1;
          \preerimage = mod(\preimage - \abov - 1, \points) + 1; % TODO: the line just above the right discs
          % is interpreted as a disc point incorrectly
          if \preerimage <= 2*\discs then { % disc point
            \endpoint = mod((2*\discs - \preimage + 1) + \shift, \points) + \abov + \points;
            if \n < \preimage then { % warps
              if \n < \endpoint then { % top warp
                return proj(\maxx - (\n - \points), \maxy, \axis);
              } else { % bottom warp
                return proj(\maxx - \n, 0, \axis);
              };
            } else { % no warp
              return proj(\maxx - abs(\preimage - \abov - \discs - 0.5), \discmidr, \axis);
            };
          } else {
            if \preimage <= \abov then { % above arc
              \endpoint = 2*\discs + \preimage;
              return proj(0, \endpoint, \axis);
            } else { % below arc
              \endpoint = mod(\n - \shift - 1, \points) + 1;
              if \n < \endpoint + \points then { % warps
                return proj(\maxx - (\n - \points), \maxy, \axis);
              } else { % no warp
                return proj(0, \endpoint, \axis);
              };
            };
          };
        };
      };
      % now actually draw it
      for \i in {1,...,\points}{
        \lx = 0;
        \ly = \maxy - \i;
        \rx = \maxx;
        \ry = \maxy - \i;
        \otherlx = otherend(\i, 0);
        \otherly = otherend(\i, 1);
        \otherrx = otherend(\i + \points, 0);
        \otherry = otherend(\i + \points, 1);
        {
          \node[dot,label=left:\i] (c) at (\lx,\ly) {};
          \node[dot,label=right:\i] (d) at (\rx,\ry) {};
          \draw (\lx,\ly) -- (\otherlx,\otherly);
          \draw (\rx,\ry) -- (\otherrx,\otherry);
        };
      };
    }
    % bounding square
    \draw (0,0) rectangle (\maxx,\maxy);
  \end{tikzpicture}
}
\begin{document}
\begin{center}
  \heegaard{11}{3}{1}{5}
\end{center}
\end{document}
% Test cases: [5, 1, 1, 2], [7, 2, 1, 3], [7, 3, 1, 5], and [11, 3, 1, 5]
% PARTIAL CORRECTNESS PROOF (no intersections)
% Accept the following lemma from the (1-1) knots paper:
